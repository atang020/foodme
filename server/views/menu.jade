extends layout

block header
	script(src='/js/menu.js')
	

block content
	div(class='modal fade', id='confirmModal', tabindex='-1', role='dialog', aria-labelledby='confirmModalLabel',aria-hidden='true')
		div(class='modal-dialog modal-sm')
			div(class='modal-header')
				button(type='button', class='close', data-dismiss='modal',aria-hidden='true') &times;
				h4(class='modal-title', id='confirmModalLabel') are you sure?
			div(class='modal-body')
				p Are you sure you want to delete this?
			div(class='modal-footer')
				button(class='btn btn-danger', type='submit') delete
				button(class='btn btn-primary', type='button', data-dismiss='modal',aria-hidden='true') cancel
	div(class='modal fade', id='inputModal', tabindex='-1', role='dialog', aria-labelledby='inputModalLabel',aria-hidden='true')
		div(class='modal-dialog modal-sm')
			div(class='modal-header')
				button(type='button', class='close', data-dismiss='modal',aria-hidden='true') &times;
				h4(class='modal-title', id='inputModalLabel') set field
			div(class='modal-body')
				input(class='signInInput', type='text')
			div(class='modal-footer')
				button(class='btn btn-primary', type='submit') submit
				button(class='btn btn-default', type='button', data-dismiss='modal',aria-hidden='true') cancel
	div.container
		div.jumbotron
			h2 Edit Menu
			
			div.panel-group(id='accordion')
				- each categoryVal, categoryKey in categories
					div.panel.panel-primary
						div.panel-heading
							h4.panel-title
								a(data-toggle='collapse', data-parent='#accordion', href='##{categoryKey}') #{categoryKey}
						div.panel-collapse.collapse(id=categoryKey)
							div.panel-body
								div.panel-group(id='#{categoryKey}Accordion')
									- for subcategory in categoryVal.subcategories
										div.panel.panel-default
											div.panel-heading.clearfix
												h4.panel-title
													a(data-toggle='collapse', data-parent='##{categoryKey}Accordion', href='##{subcategory.name}') #{subcategory.name}
													div.btn-group.pull-right
														button.btn.btn-primary(type='button', data-toggle='modal', data-target='#inputModal') rename
														button.btn.btn-danger(type='button', data-toggle='modal', data-target='#confirmModal') delete
											div.panel-collapse.collapse(id='#{subcategory.name}')
												div.panel-body(style='padding-bottom:40px')
														table.table
															thead
																tr
																	th name
																	th price
																	th photo
																	th description
															tbody
																- for (var i = 0; i < subcategory.items.length + 1; ++i)
																	-var item=subcategory.items[i]
																	-var visibility='visible'
																	-var rowClass='normal'
																	-if(!item)
																		- var item={}
																		-var rowClass='hidden'
																	tr(class=rowClass)
																		td
																			div.dropdown
																				- if(item.name)
																					a(data-toggle='dropdown', href='#') #{item.name}
																				-else
																					a(data-toggle='dropdown', href='#') (untitled)
																				ul.dropdown-menu(role='menu')
																					li
																						a(href='#', data-toggle='modal', data-target='#inputModal') rename
																					li
																						a(href='#', data-toggle='modal', data-target='#confirmModal') delete
																		td
																			div.dropdown
																				- if(item.price)
																					a(data-toggle='dropdown', href='#') #{item.price}
																				- else
																					a(data-toggle='dropdown', href='#') (none)
																				ul.dropdown-menu(role='menu')
																					li
																						a(href='#', data-toggle='modal', data-target='#inputModal') set price
																		td
																			div.dropdown
																				- if(item.photo)
																					a(data-toggle='dropdown', href='#') #{item.photo}
																					ul.dropdown-menu(role='menu')
																						li
																							a(href='#', data-toggle='modal', data-target='#inputModal') change photo
																						li
																							a(href='#', data-toggle='modal', data-target='#confirmModal') delete photo
																				- else
																					a(data-toggle='dropdown', href='#') (none)
																						ul.dropdown-menu(role='menu')
																							li
																								a(href='#', data-toggle='modal', data-target='#inputModal') upload photo
																		td #{item.description}
																				div.dropdown
																					- if(item.description)
																						a(data-toggle='dropdown', href='#') #{item.description}
																						ul.dropdown-menu(role='menu')
																							li
																								a(href='#', data-toggle='modal', data-target='#inputModal') change description
																							li
																								a(href='#', data-toggle='modal', data-target='#confirmModal') delete description
																					- else
																						a(data-toggle='dropdown', href='#') (none)
																							ul.dropdown-menu(role='menu')
																								li
																									a(href='#', data-toggle='modal', data-target='#inputModal') add description
																tr
														a(onclick='addItem(\'#{categoryKey}\', \'#{subcategory.name}\')', rel='nofollow') + new item
									div.panel.panel-success
										div.panel-heading
											h4.panel-title
												a(data-toggle='collapse', data-parent='##{categoryKey}Accordion', href='##{categoryKey}New') + new #{categoryKey} subcategory
										div.panel-collapse.collapse(id='#{categoryKey}New')
											div.panel-body
												form
													div.form-group
														input(type='text', placeholder='subcategory name')
													button(class='btn btn-primary', type='submit') add
						
						